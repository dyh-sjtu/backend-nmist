<% include ../includes/backend-head.ejs %>
<body style="overflow-x: hidden;background-color: #eee;">
<% include ../includes/backend-header.ejs %>
<div class="main">
    <% include ../includes/backend-sidebar.ejs %>
    <div class="backend-container">
        <div class="row pb-10" style="margin-right: 0;margin-left: 0">
            <h2 class="w100 tc"><%= customer && customer._id ? "å®¢æˆ·æ¡ˆä¾‹æ›´æ–°" : "å®¢æˆ·æ¡ˆä¾‹æ·»åŠ " %></h2>
        </div>
        <hr class="layui-bg-blue pt-5">
        <div class="backend-content" style="background-color: #fff">
            <div class="layui-form" style="padding: 0 15px">
                <div class="layui-form-item">
                    <div class="layui-input-block">
                        <input type="hidden" value="<%= customer && customer._id %>" class="layui-input"
                               id="customer_id">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label" for="customer_title">å®¢æˆ·æ¡ˆä¾‹å›¾ç‰‡åç§°</label>
                    <div class="layui-input-block">
                        <input type="text" value="<%= customer && customer.title %>"
                               placeholder="è¯·è¾“å…¥å®¢æˆ·æ¡ˆä¾‹å›¾ç‰‡åç§°"
                               autocomplete="on" class="layui-input" id="customer_title">
                    </div>
                </div>

                <div class="layui-form-item">
                    <label class="layui-form-label">å®¢æˆ·æ¡ˆä¾‹ç±»å‹</label>
                    <div class="layui-input-block">
                        <input type="radio" name="customer_type" value="1" title="æˆ˜ç•¥åˆä½œ" checked>
                        <input type="radio" name="customer_type" value="2" title="BIMå’¨è¯¢å…¬å¸">
                        <input type="radio" name="customer_type" value="3" title="ç ”ç©¶ä¸­å¿ƒåˆä½œå•ä½">
                    </div>
                </div>

                <div class="layui-form-item">
                    <label class="layui-form-label" for="customer_url">å®¢æˆ·æ¡ˆä¾‹å‹æƒ…é“¾æ¥åœ°å€</label>
                    <div class="layui-input-block">
                        <input type="text" value="<%= customer && customer.url %>"
                               placeholder="è¯·è¾“å…¥å®¢æˆ·æ¡ˆä¾‹å‹æƒ…é“¾æ¥åœ°å€"
                               autocomplete="on" class="layui-input" id="customer_url">
                    </div>
                </div>

                <div class="layui-form-item">
                    <label class="layui-form-label" for="customer_src">å®¢æˆ·æ¡ˆä¾‹å›¾ç‰‡åœ°å€</label>
                    <div class="layui-input-block">
                        <input type="text" value="<%= customer && customer.src %>"
                               placeholder="è¯·è¾“å…¥å®¢æˆ·æ¡ˆä¾‹å›¾ç‰‡åœ°å€"
                               autocomplete="on" class="layui-input" id="customer_src">
                    </div>
                </div>

                <div class="layui-form-item mt-30 pb-30">
                    <div class="layui-input-block">
                        <button class="layui-btn" type="button" id="save_customer">ä¿å­˜</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
	$(document).ready(function () {
		layer.config({
			title: 'æç¤º'
		})

		layui.use('form', function () {
			var form = layui.form;
		})

		$("#save_customer").bind('click', function () {
			var customer_id = $('#customer_id').val();
			var customer_title = $('#customer_title').val();
			var customer_type = $("input[name='customer_type']:checked").val();
			var customer_src = $('#customer_src').val();
			var customer_url = $('#customer_url').val();
			if (!(customer_title.trim() && customer_src.trim() && customer_url.trim())) {
				layer.msg("å®¢æˆ·æ¡ˆä¾‹å›¾ç‰‡ä¿¡æ¯ä¸èƒ½ä¸ºç©ºå“¦ğŸ˜¯!");
				return;
			}

			$.ajax({
				type: 'POST',
				url: '/admin/customer/save',
				data: {
					customerId: customer_id,
					title: customer_title,
					type: parseInt(customer_type),
					src: customer_src,
					url: customer_url
				}
			}).done(function (res) {
				if (res.success === 1) {
					layer.msg("å®¢æˆ·æ¡ˆä¾‹å›¾ç‰‡ä¿¡æ¯ä¿å­˜æˆåŠŸ!")
					location.replace('/admin/customerList')
				}
			})

		})
	})
</script>
</body>